<ul class="grid_11">
    <li>
    <div class="clear"></div>
    <div class="single_wrap">
        <div class="padder">
Verifying your account lets you post comments and submit stories to Lonava, by letting everyone know who you are.<br>
It should only take a few moments, and only costs <strike>$5</strike> $1.05, as a one-time fee.<br>
<br><br>
<h2>Your billing information: 
</h2> 

{% if uid == "0" %}

Before you can verify your account, first you need to <a href="/register">Create an Account</a><br>
Sorry for the difficulty. This page isn't linked to on the not-logged-in page anywhere, so I had hoped you wouldn't come here unless you were already registered.<br>
<br><br>
If you already are logged in, try to make sure that your browser is saving cookies; It should say your name in the top-right corner of the screen.
{%end%} 

{% if long(ustatus) > 0 %}
You're account has already been verified! ;)<br>
You don't need to do anything here.
{% end %}

{%if (uid != "0") and (long(ustatus) < 1) %}
<form action="/verify/{{uid}}" method="post"> 

<fieldset id="name_and_email"> 
    <div id="first_name" class="stack"> 
        <label for="credit_card_first_name">First Name</label> 
        <input id="credit_card_first_name" name="credit_card[first_name]" size="30" type="text" value="" /> 
    </div> 

    <div id="last_name" class="stack"> 
        <label for="credit_card_last_name">Last Name</label> 
        <input id="credit_card_last_name" name="credit_card[last_name]" size="30" type="text" value="" /> 
    </div> 
</fieldset> 
<br>
<fieldset id="address_and_location">
    <div id="address-1" class="stack">
        <label for="credit_card_address_1">Address</label>
        <input id="credit_card_address_1" name="credit_card[address-1]" size="30" type="text" value="" />
    </div>

    <div id="address-2" class="stack">
        <label for="credit_card_address_2">Address 2</label>
        <input id="credit_card_address_2" name="credit_card[address-2]" size="30" type="text" value="" />
    </div>
</fieldset>

<fieldset id="city_and_state">
    <div id="city" class="stack">
        <label for="credit_card_city">City</label>
        <input id="credit_card_city" name="credit_card[city]" size="30" type="text" value="" />
    </div>
    <div id="state" class="stack">
        <label for="credit_card_state">State</label>
        <select id="credit_card_state" name="credit_card[state]">
            <option value="AL">Alabama</option>
            <option value="AK">Alaska</option>
            <option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option>
            <option value="CA">California</option>
            <option value="CO">Colorado</option>
            <option value="CT">Connecticut</option>
            <option value="DE">Delaware</option>
            <option value="DC">Dist of Columbia</option>
            <option value="FL">Florida</option>
            <option value="GA">Georgia</option>
            <option value="HI">Hawaii</option>
            <option value="ID">Idaho</option>
            <option value="IL">Illinois</option>
            <option value="IN">Indiana</option>
            <option value="IA">Iowa</option>
            <option value="KS">Kansas</option>
            <option value="KY">Kentucky</option>
            <option value="LA">Louisiana</option>
            <option value="ME">Maine</option>
            <option value="MD">Maryland</option>
            <option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option>
            <option value="MN">Minnesota</option>
            <option value="MS">Mississippi</option>
            <option value="MO">Missouri</option>
            <option value="MT">Montana</option>
            <option value="NE">Nebraska</option>
            <option value="NV">Nevada</option>
            <option value="NH">New Hampshire</option>
            <option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option>
            <option value="NY">New York</option>
            <option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option>
            <option value="OH">Ohio</option>
            <option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option>
            <option value="PA">Pennsylvania</option>
            <option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option>
            <option value="SD">South Dakota</option>
            <option value="TN">Tennessee</option>
            <option value="TX">Texas</option>
            <option value="UT">Utah</option>
            <option value="VT">Vermont</option>
            <option value="VA">Virginia</option>
            <option value="WA">Washington</option>
            <option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option>
            <option value="WY">Wyoming</option>
        </select>
    </div>
    <div id="zip" class="stack">
        <label for="credit_card_zip">Zip Code</label>
        <input id="credit_card_zip" name="credit_card[zip]" size="30" type="text" value="" />
    </div>
</fieldset>                                     
<br>

<fieldset id="card_layout"> 
    <div class="paragraph"> 
        <label for="credit_card_card_type">Card Type</label> 
        <select id="credit_card_card_type" name="credit_card[card_type]">
            <option value="Visa">Visa</option> 
            <option value="Mastercard">Mastercard</option> 
            <option value="Amex">American Express</option> 
            <option value="Discover">Discover</option></select> 
    </div> 

    <div class="stacked"> 
        <div class="stack" id="number"> 
            <label for="credit_card_number">Card Number</label> 
            <input id="credit_card_number" name="credit_card[number]" size="30" type="text" onblur="
            // save input string and strip out non-numbers
            cc_number_saved = this.value;
            this.value = this.value.replace(/[^\d]/g, '');
            if(!checkLuhn(this.value)) {
            $.blockUI({ message: 'That does not appear to be a valid Credit Card number.',overlayCSS: { backgroundColor: '#4a525a' } });
            setTimeout($.unblockUI, 2000);


            this.value = '';
            }
            " onFocus="
            // restore saved string
            if(this.value != cc_number_saved) this.value = cc_number_saved;
            ">
        </div> 
        <div class="stack" id="code"> 
            <label for="credit_card_verification_value">Security Code</label> 
            <input id="credit_card_verification_value" name="credit_card[verification_value]" size="30" type="text" /> 
            <img alt="Security_code" id="security_code_image" src="/static/security_code.gif" /> 
            <span class="note" id="security_code_note">Last 3-4 digits on the back</span> 
        </div> 
    </div> 

    <div class="paragraph"> 
        <label for="credit_card_month">Expiration Date</label> 
        <select id="credit_card_month" name="credit_card[month]"> 
            <option value="01">1 - January</option> 
            <option value="02">2 - February</option> 
            <option value="03">3 - March</option> 
            <option value="04">4 - April</option> 
            <option value="05">5 - May</option> 
            <option value="06">6 - June</option> 
            <option value="07">7 - July</option> 
            <option value="08">8 - August</option> 
            <option value="09">9 - September</option> 
            <option value="10">10 - October</option> 
            <option value="11">11 - November</option> 
            <option value="12">12 - December</option> 
        </select> 
        <select id="credit_card_year" name="credit_card[year]"> 
            <option value="2010">2010</option> 
            <option value="2011">2011</option> 
            <option value="2012">2012</option> 
            <option value="2013">2013</option> 
            <option value="2014">2014</option> 
            <option value="2015">2015</option> 
            <option value="2016">2016</option> 
            <option value="2017">2017</option> 
            <option value="2018">2018</option> 
            <option value="2019">2019</option> 
            <option value="2020">2020</option> 
            <option value="2021">2021</option> 
            <option value="2022">2022</option> 
            <option value="2023">2023</option> 
            <option value="2024">2024</option> 
            <option value="2025">2025</option> 
        </select> 

    </div> 
</fieldset> 
<br>
<input type="submit" value="Verify"> 
<p>
Please note that after pressing "Verify", we will charge your card the <strike>$5</strike> $1.05 Verification fee, as well as check your information against both public and private databases to ascertain if you are who you say you are. This does NOT involve running a credit-check, and will not negatively affect you. Unless you're hoping to troll the site; Then, hopefully, it'll stop you. ;) </p>
</form>
{% end %}

<script type="text/javascript">
    // initialise variable to save cc input string
var cc_number_saved = "";
function checkLuhn(input)
{
    var sum = 0;
    var numdigits = input.length;
    var parity = numdigits % 2;
    for(var i=0; i < numdigits; i++) {
        var digit = parseInt(input.charAt(i))
            if(i % 2 == parity) digit *= 2;
        if(digit > 9) digit -= 9;
        sum += digit;
    }
    return (sum % 10) == 0;
}
</script>
</div>
</div>
</li>
</ul>

